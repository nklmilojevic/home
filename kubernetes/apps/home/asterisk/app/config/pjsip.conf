; Asterisk PJSIP Configuration for DVC DX470 Intercom
; Local SIP server at 10.50.0.248:5060 (via multus-iot)

[global]
type=global
user_agent=Asterisk Home

[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060

[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5060

[transport-ws]
type=transport
protocol=ws

; ===========================================
; DVC DX470 Intercom Extension
; ===========================================
[640000033c9b]
type=endpoint
context=intercom-inbound
disallow=all
allow=g722
allow=alaw
allow=ulaw
allow=h264
aors=640000033c9b
auth=640000033c9b-auth
callerid="Door Intercom" <8000>
direct_media=no
dtmf_mode=info
force_rport=yes
rewrite_contact=yes
rtp_symmetric=yes
ice_support=no

[640000033c9b]
type=aor
max_contacts=1
remove_existing=yes
qualify_frequency=30

[640000033c9b-auth]
type=auth
auth_type=userpass
username=640000033c9b
password=49115

[640000033c9b-identify]
type=identify
endpoint=640000033c9b
match=10.50.0.190

; ===========================================
; Home Assistant SIP Extension (for SIP Core)
; ===========================================
[homeassistant]
type=endpoint
context=default
disallow=all
allow=opus
allow=g722
allow=alaw
allow=ulaw
allow=h264
allow=vp8
aors=homeassistant
auth=homeassistant-auth
callerid="Home Assistant" <100>
direct_media=no
dtmf_mode=rfc4733
webrtc=yes

[homeassistant]
type=aor
max_contacts=5
remove_existing=no

[homeassistant-auth]
type=auth
auth_type=userpass
username=homeassistant
password=hass123

; ===========================================
; Additional dashboard extensions
; ===========================================
[dashboard-101]
type=endpoint
context=default
disallow=all
allow=opus
allow=g722
allow=alaw
allow=ulaw
allow=h264
allow=vp8
aors=dashboard-101
auth=dashboard-101-auth
callerid="Dashboard 101" <101>
direct_media=no
webrtc=yes

[dashboard-101]
type=aor
max_contacts=1

[dashboard-101-auth]
type=auth
auth_type=userpass
username=101
password=hass123

[dashboard-102]
type=endpoint
context=default
disallow=all
allow=opus
allow=g722
allow=alaw
allow=ulaw
allow=h264
allow=vp8
aors=dashboard-102
auth=dashboard-102-auth
callerid="Dashboard 102" <102>
direct_media=no
webrtc=yes

[dashboard-102]
type=aor
max_contacts=1

[dashboard-102-auth]
type=auth
auth_type=userpass
username=102
password=hass123

; ===========================================
; Linphone test extension (no webrtc)
; ===========================================
[103]
type=endpoint
context=default
disallow=all
allow=g722
allow=alaw
allow=ulaw
aors=103
auth=103-auth
callerid="Linphone" <103>
direct_media=no

[103]
type=aor
max_contacts=1

[103-auth]
type=auth
auth_type=userpass
username=103
password=hass123
